jQuery(function(n){var r={init:function(){this.init_event()},profile_picture_upload:function(e){var r=user_registration_params.ajax_url+"?action=user_registration_profile_pic_upload&security="+user_registration_params.user_registration_profile_picture_upload_nonce,t=new FormData,i=e,o=(t.append("file",i[0].files[0]),i.closest(".button-group").find(".user_registration_profile_picture_upload")),a=o.text();n.ajax({url:r,data:t,type:"POST",processData:!1,contentType:!1,beforeSend:function(){o.text(user_registration_params.user_registration_profile_picture_uploading)},complete:function(e){var r,t="",e=(i.val(""),JSON.parse(e.responseText)),t=e.data.message;e.success||(t='<p class="uraf-profile-picture-error user-registration-error">'+t+"</p>"),e.success&&(t="",r=e.data.url,e.data.attachment_id,upload_files=e.data.upload_files,i.closest(".button-group").find("#profile_pic_url").val(upload_files),i.closest(".user-registration-profile-header").find(".profile-preview").attr("src",r)),i.closest(".button-group").find(".profile-pic-remove").data("attachment-id",e.data.attachment_id),i.closest(".button-group").find(".profile-pic-remove").prop("style",!1),i.closest(".button-group").find(".user_registration_profile_picture_upload").attr("style","display:none"),i.closest(".user-registration-profile-header").find(".user-registration-profile-picture-error").remove(),i.closest(".button-group").after('<span class="user-registration-profile-picture-error">'+t+"</span>"),o.text(a)}})},init_event:function(){n(".user_registration_profile_picture_upload").on("click",function(){n(this).closest(".button-group").find('input[type="file"]').trigger("click")}),n(document).on("change",'.button-group input[type="file"]',function(){r.profile_picture_upload(n('.button-group input[type="file"]'))})},remove_avatar:function(e){var r=e.data("attachment-id"),t=(e.closest("form").find(".ur_removed_profile_pic").length<=0&&((t=document.createElement("input")).setAttribute("type","hidden"),t.setAttribute("class","ur_removed_profile_pic"),t.setAttribute("name","ur_removed_profile_pic"),t.setAttribute("value",""),e.closest("form").append(t)),e.closest("form").find(".ur_removed_profile_pic").val()),t=new Set(t?JSON.parse(t):[]);t.add(r),e.closest("form").find(".ur_removed_profile_pic").val(JSON.stringify(Array.from(t))),e.closest("form").find('input[name="profile-pic"]');input_hidden=e.closest("form").find('input[name="profile-pic-url"]'),profile_default_input_hidden=e.closest("form").find('input[name="profile-default-image"]'),preview=e.closest("form").find("img.profile-preview"),input_hidden.val(""),preview.attr("src",profile_default_input_hidden.val()),e.hide(),e.closest(".button-group").find(".user_registration_profile_picture_upload").show(),e.closest(".user-registration-profile-header").find(".user-registration-profile-picture-error").remove()}};n(".profile-pic-remove").on("click",function(e){e.preventDefault(),r.remove_avatar(n(this))}),n(document).on("user_registration_frontend_before_edit_profile_submit",function(e,r,t){var i=n(".ur_removed_profile_pic");n.each(i,function(){r.ur_removed_profile_pic=n(this).val()})}),n(document).on("click","input#user_registration_user_email + div.email-updated.inline a",function(e){e.preventDefault();var r=n(this),e=new URL(e.target.href),t=e.searchParams.get("cancel_email_change"),e=e.searchParams.get("_wpnonce"),i=user_registration_params.ajax_url;n.ajax({type:"POST",url:i,data:{action:"user_registration_cancel_email_change",cancel_email_change:t,_wpnonce:e},success:function(e){e.success&&r.parents("div.email-updated.inline").remove()}})}),n(".ur-frontend-form").find(".user-registration-profile-header").find(".uraf-profile-picture-upload").length||(r.init(),n(".edit-profile").on("submit",function(e){var r,t,i=n(".ur-smart-phone-field");return"true"===i.attr("aria-invalid")?(e.preventDefault(),(r=i.closest("p.form-row")).find("#"+i.data("id")+"-error").remove(),t='<label id="'+i.data("id")+'-error" class="user-registration-error" for="'+i.data("id")+'">'+user_registration_params.message_validate_phone_number+"</label>",r.append(t),r.find("#"+i.data("id")).attr("aria-invalid",!0),!0):1===n(this).find(".user-registration-profile-picture-error").find(".user-registration-error").length?(e.preventDefault(),!0):void 0})),n("input.flatpickr-input").each(function(){n(this).val(n(this).attr("value"))})});